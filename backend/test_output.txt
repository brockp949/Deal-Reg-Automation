
> dealreg-backend@1.0.0 test
> jest robustMboxSplitter

FAIL src/__tests__/parsers/robustMboxSplitter.test.ts (18.204 s)
  test setup
    ΓêÜ should initialize test environment (3 ms)
  Robust MBOX Splitter
    isMboxDelimiterLine
      ΓêÜ should identify standard MBOX From lines (1 ms)
      ΓêÜ should reject From: headers (1 ms)
      ΓêÜ should reject lines starting with >From (1 ms)
      ├ù should handle missing date/time strictness if previous line was empty (3 ms)
      ΓêÜ should reject weak lines if previous line was NOT empty (strict check) (1 ms)
      ΓêÜ should handled complex email addresses (1 ms)
      ├ù should handle minimal date parts if year and time present (1 ms)

  ΓùÅ Robust MBOX Splitter ΓÇ║ isMboxDelimiterLine ΓÇ║ should handle missing date/time strictness if previous line was empty

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      24 |             const line = 'From user@example.com';
      25 |             // Weak signal, but if prev line was empty, we accept it as per fallback
    > 26 |             expect(isMboxDelimiterLine(line, true)).toBe(true);
         |                                                     ^
      27 |         });
      28 |
      29 |         it('should reject weak lines if previous line was NOT empty (strict check)', () => {

      at Object.<anonymous> (src/__tests__/parsers/robustMboxSplitter.test.ts:26:53)

  ΓùÅ Robust MBOX Splitter ΓÇ║ isMboxDelimiterLine ΓÇ║ should handle minimal date parts if year and time present

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      40 |             // E.g. simplified format
      41 |             const line = 'From foo@bar 2023 12:00:00';
    > 42 |             expect(isMboxDelimiterLine(line, false)).toBe(true);
         |                                                      ^
      43 |         });
      44 |     });
      45 | });

      at Object.<anonymous> (src/__tests__/parsers/robustMboxSplitter.test.ts:42:54)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 6 passed, 8 total
Snapshots:   0 total
Time:        18.627 s, estimated 25 s
Ran all test suites matching robustMboxSplitter.
